<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Usage</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Usage</h1>



<div id="tutorial-package-calidad" class="section level1">
<h1>Tutorial package calidad</h1>
<p>The package aims to implement in a simple way the methodologies of <a href="https://www.ine.cl/docs/default-source/documentos-de-trabajo/20200318-lineamientos-medidas-de-precisi%C3%B3n.pdf?sfvrsn=f1ab2dbe_4">INE
Chile</a>, <a href="https://repositorio.cepal.org/bitstream/handle/11362/45681/S2000293_es.pdf?sequence=4&amp;isAllowed=y">ECLAC
2020</a> and <a href="https://repositorio.cepal.org/server/api/core/bitstreams/f04569e6-4f38-42e7-a32b-e0b298e0ab9c/content">ECLAC
2023</a> for the quality assessment of estimates from household surveys
and <a href="https://www.ine.gob.cl/docs/default-source/buenas-practicas/directrices-metodologicas/estandares/documentos/est%C3%A1ndar-evaluaci%C3%B3n-de-calidad-de-estimaciones-econ%C3%B3micas.pdf?sfvrsn=201fbeb9_2">INE
Chile Economics Surveys 2024</a> for the quality assessment of estimates
from economics surveys.</p>
<p>This tutorial shows the basic use of the package and includes the
main functions to create the necessary inputs to implement the quality
standards.</p>
<div id="data-edition" class="section level2">
<h2>Data edition</h2>
<p>We will use three datasets:</p>
<ul>
<li>Encuesta Nacional de Empleo (efm 2020)<br />
</li>
<li>VIII Encuesta de Presupuestos Familiares<br />
</li>
<li>VII Encuesta longitudinal de Empresas (ELE7)</li>
</ul>
<p>Those datasets are loaded into the package and they can be used when
the package is loaded in the session <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. The data edition in the case of ENE has
the purpuse of creating some subpopulations (work force, unemployed and
unemployed).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(calidad)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>ene <span class="ot">&lt;-</span> ene <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fdt =</span> <span class="fu">if_else</span>(cae_especifico <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> cae_especifico <span class="sc">&lt;=</span> <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="co"># labour force</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>         <span class="at">ocupado =</span> <span class="fu">if_else</span>(cae_especifico <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> cae_especifico <span class="sc">&lt;=</span> <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="co"># employed</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>         <span class="at">desocupado =</span> <span class="fu">if_else</span>(cae_especifico <span class="sc">&gt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> cae_especifico <span class="sc">&lt;=</span> <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>         <span class="at">hombre =</span> <span class="fu">if_else</span>(sexo <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>         <span class="at">mujer =</span> <span class="fu">if_else</span>(sexo <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="co"># unemployed</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co"># One row per household</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>epf <span class="ot">&lt;-</span> epf_personas <span class="sc">%&gt;%</span> </span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  <span class="fu">group_by</span>(folio) <span class="sc">%&gt;%</span> </span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
</div>
<div id="sample-design" class="section level2">
<h2>Sample design</h2>
<p>Before starting to use the package, it is necessary to declare the
sample design of the survey, for which we use the <code>survey</code>
package. The primary sample unit, the stratum and weights must be
declared. It is also possible to use a design with only weights,
nevertheless in that case the variance will be estimated under simple
random sampling assumption. In this case we will declare a complex
design for the two surveys (EPF and ENE). Additionally, it may be useful
to declare an option for strata that only have one PSU.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Store original options</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>old_options <span class="ot">&lt;-</span>  <span class="fu">options</span>()</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Complex sample design for ENE</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>dc_ene <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>conglomerado , <span class="at">strata =</span> <span class="sc">~</span>estrato_unico, <span class="at">data =</span> ene, <span class="at">weights =</span> <span class="sc">~</span>fact_cal)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Complex sample design for EPF</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>dc_epf <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>varunit, <span class="at">strata =</span> <span class="sc">~</span>varstrat, <span class="at">data =</span> epf, <span class="at">weights =</span> <span class="sc">~</span>fe)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu =</span> <span class="st">&quot;certainty&quot;</span>)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<p>For ELE survey, we also must to declare the fpc (finite population
correction)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Complex sample design for ELE</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>dc_ele <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>rol_ficticio, <span class="at">weights =</span> <span class="sc">~</span>fe_transversal, <span class="at">strata =</span> <span class="sc">~</span>estrato, <span class="at">fpc =</span> <span class="sc">~</span>pob, <span class="at">data =</span> ELE7)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu =</span> <span class="st">&#39;remove&#39;</span>)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
</div>
<div id="inputs-creation" class="section level2">
<h2>Inputs creation</h2>
<div id="national-labour-survey-part-1" class="section level3">
<h3>National Labour Survey (part 1)</h3>
<p>To assess the quality of an estimate, the <a href="https://www.ine.cl/docs/default-source/documentos-de-trabajo/20200318-lineamientos-medidas-de-precisi%C3%B3n.pdf?sfvrsn=f1ab2dbe_4">INE
methodology</a> establishes differentiated criteria for estimates of
proportion or ratio between 0 and 1, on the one hand, and estimates of
mean, size and total, on the other. In the case of proportion
estimation, it is necessary to have the sample size, the degrees of
freedom and the standard error. The other estimates require the sample
size, the degrees of freedom, and the coefficient of variation.</p>
<p>The package includes separate functions to create the inputs for
estimates of <strong>mean, proportion, totals and size</strong>. The
following example shows how the proportion and size functions are
used.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>insumos_prop <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&quot;desocupado&quot;</span>, <span class="at">domains =</span> <span class="st">&quot;sexo&quot;</span>, <span class="at">subpop =</span> <span class="st">&quot;fdt&quot;</span>, <span class="at">design =</span>  dc_ene) <span class="co"># proportion of unemployed people</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>insumos_total <span class="ot">&lt;-</span>  <span class="fu">create_size</span>(<span class="at">var =</span> <span class="st">&quot;desocupado&quot;</span>, <span class="at">domains =</span> <span class="st">&quot;sexo&quot;</span>, <span class="at">subpop =</span> <span class="st">&quot;fdt&quot;</span>, <span class="at">design =</span>  dc_ene) <span class="co"># number of unemployed people</span></span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<ul>
<li><code>var</code>: variable to be estimated. Must be a dummy
variable</li>
<li><code>domains</code>: required domains.</li>
<li><code>subpop</code>: reference subpopulation. It is optional and
works as a filter (must be a dummy variable)</li>
<li><code>design</code>: sample design</li>
</ul>
<p>The function returns all the neccesary inputs to implement the
standard</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>insumos_total</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt;   sexo     stat       se  df    n         cv</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; 1    1 399299.4 14530.92 880 1564 0.03639102</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; 2    2 402505.4 14688.19 913 1629 0.03649190</span></span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<p>To get more domains, we can use the “+” symbol as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>desagregar <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&quot;desocupado&quot;</span>, <span class="at">domains =</span> <span class="st">&quot;sexo+region&quot;</span>, <span class="at">subpop =</span> <span class="st">&quot;fdt&quot;</span>, <span class="at">design =</span>  dc_ene)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<p>A useful parameter is <code>eclac_input</code>. It allows to return
the ECLAC inputs. By default this parameter is <code>FALSE</code> and
with the option <code>TRUE</code> we can activate it.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>eclac_inputs <span class="ot">&lt;-</span>  <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&quot;desocupado&quot;</span>, <span class="at">domains =</span> <span class="st">&quot;sexo+region&quot;</span>, <span class="at">subpop =</span> <span class="st">&quot;fdt&quot;</span>, <span class="at">design =</span>  dc_ene, <span class="at">eclac_input =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<p>In some cases, it may be of interest to assess the estimate of a
ratio. The <code>create_prop</code> function allows ratio estimation by
explicitly specifying the numerator and the denominator. To do this, the
function includes the denominator parameter, where the variable to be
used in the denominator of the ratio must be provided.</p>
<p>For ECLAC standards, it is necessary to specify the version of the
methodology using the scheme parameter, since ratio estimation is only
supported under the ECLAC 2023 standard (<code>eclac_2023</code>). The
default option is <code>eclac_2020</code>, which does not include
support for ratio estimation. An example using <code>eclac_2023</code>
is shown below:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&quot;mujer&quot;</span>, <span class="at">denominator =</span> <span class="st">&quot;hombre&quot;</span>, <span class="at">domains =</span> <span class="st">&quot;ocupado&quot;</span>, <span class="at">design =</span> dc_ene,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>            <span class="at">eclac_input =</span> <span class="cn">TRUE</span>, <span class="at">scheme =</span> <span class="st">&#39;eclac_2023&#39;</span>)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
</div>
<div id="household-budget-survey-part-2" class="section level3">
<h3>Household Budget Survey (part 2)</h3>
<p>We may also be interested in assessing the estimate of a sum. For
example, the sum of all the income of the EPF at the geographical area
level (Gran Santiago and other regional capitals). For this, there is
the <code>create_total</code> function. This function receives a
continuous variable such as hours, expense, or income and generates
totals at the requested level. The ending “with” of the function alludes
to the fact that a continuous variable is being used.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>insumos_suma <span class="ot">&lt;-</span>  <span class="fu">create_total</span>(<span class="at">var =</span> <span class="st">&quot;gastot_hd&quot;</span>, <span class="at">domains =</span> <span class="st">&quot;zona&quot;</span>, <span class="at">design =</span>  dc_epf)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<p>If we want to assess the estimate of a mean, we have the function
<code>create_mean</code>. In this case, we will calculate the average
expenditure of households, according to geographical area.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>insumos_media <span class="ot">&lt;-</span>  <span class="fu">create_mean</span>(<span class="at">var =</span> <span class="st">&quot;gastot_hd&quot;</span>, <span class="at">domains =</span> <span class="st">&quot;zona&quot;</span>, <span class="at">design =</span>  dc_epf)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<p>The default usage is not to disaggregate, in which case the functions
should be used as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># ENE dataset</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>insumos_prop_nacional <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="st">&quot;desocupado&quot;</span>, <span class="at">subpop =</span> <span class="st">&quot;fdt&quot;</span>, <span class="at">design =</span> dc_ene)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>insumos_total_nacional <span class="ot">&lt;-</span>  <span class="fu">create_total</span>(<span class="st">&quot;desocupado&quot;</span>, <span class="at">subpop =</span> <span class="st">&quot;fdt&quot;</span>, <span class="at">design =</span> dc_ene)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># EPF dataset</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>insumos_suma_nacional <span class="ot">&lt;-</span> <span class="fu">create_total</span>(<span class="st">&quot;gastot_hd&quot;</span>, <span class="at">design =</span> dc_epf)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>insumos_media_nacional <span class="ot">&lt;-</span>  <span class="fu">create_mean</span>(<span class="st">&quot;gastot_hd&quot;</span>, <span class="at">design =</span> dc_epf)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<p>The create functions also include a <code>ci</code> parameter, which
allows returning the confidence interval. By default, this parameter is
set to <code>FALSE.</code> For proportions, the logistic confidence
interval is available. To use it, you need to set
<code>ci_logit = TRUE</code>, as shown below:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># ENE dataset</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>prop_nacional_ci <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="st">&quot;desocupado&quot;</span>, <span class="at">subpop =</span> <span class="st">&quot;fdt&quot;</span>, <span class="at">design =</span> dc_ene, <span class="at">ci =</span> <span class="cn">TRUE</span>)                        </span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>prop_nacional_ci_logit <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="st">&quot;desocupado&quot;</span>, <span class="at">subpop =</span> <span class="st">&quot;fdt&quot;</span>, <span class="at">design =</span> dc_ene, <span class="at">ci_logit =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
</div>
<div id="longitudinal-enterprise-survey-part-3" class="section level3">
<h3>Longitudinal Enterprise Survey (part 3)</h3>
<p>In the case of economic surveys, the estimates are carried out in a
similar way. For example, in the Longitudinal Enterprise Survey (ELE),
wage productivity is estimated as the ratio between value added and the
total gross remuneration of personnel hired by the company.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>prod_salarial <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="st">&#39;VA_2022f&#39;</span>, <span class="at">denominator =</span> <span class="st">&#39;REMP_TOTAL&#39;</span>, <span class="at">domains =</span> <span class="st">&#39;cod_actividad+cod_tamano&#39;</span>, <span class="at">design =</span> dc_ele)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
</div>
</div>
<div id="assessment" class="section level2">
<h2>Assessment</h2>
<p>Once the inputs have been generated, we can proceed with the
assessment using the <code>assess</code> function. By default, the INE
Chile criteria are applied (<code>scheme = &#39;chile&#39;</code>). However, if
we want to evaluate using the ECLAC or Chile Economics criteria, we need
to specify <code>scheme = &#39;eclac_2020&#39;</code>,
<code>scheme = &#39;eclac_2023&#39;</code>, or
<code>scheme = &#39;chile_economics&#39;</code>.</p>
<p>For the ECLAC 2023 standard (<code>eclac_2023</code>), we can use the
parameters <code>domain_info</code> and <code>low_df_justified</code> to
indicate whether the estimation corresponds to a planned study domain
and whether low degrees of freedom are justified. Both parameters are
set to <code>FALSE</code> by default.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co"># INE Chile</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>evaluacion_prop <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_prop)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>evaluacion_tot <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_total)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>evaluacion_suma <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_suma)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>evaluacion_media <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_media)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co"># ECLAC </span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>evaluacion_cepal_2020 <span class="ot">&lt;-</span> <span class="fu">assess</span>(eclac_inputs, <span class="at">scheme =</span> <span class="st">&#39;eclac_2020&#39;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>evaluacion_cepal_2023 <span class="ot">&lt;-</span> <span class="fu">assess</span>(eclac_inputs, <span class="at">scheme =</span> <span class="st">&#39;eclac_2023&#39;</span>, <span class="at">domain_info =</span> <span class="cn">TRUE</span>, <span class="at">low_df_justified =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<p>In the INE Chile Economics standard (<code>chile_economics</code>),
the <code>domain_info</code> parameter is also available, and the
<code>table_n_obj</code> parameter can be used to specify the target
sample size for the domains to be evaluated, using a data frame. This
data frame must include the target sample size in a column named
<code>n_obj</code>. By default, <code>table_n_obj</code> is
<code>NULL</code>, and the sample recovery verification will be
skipped.</p>
<p>For the assessment of ratios, we can indicate whether the estimated
value falls between 0 and 1 using the parameter
<code>ratio_between_0_1</code>. By default, it is set to
<code>TRUE</code>. If a value greater than 1 is detected, the
coefficient of variation (CV) will be used instead.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># INE Economics</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="do">## target sample size</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>table_n_obj <span class="ot">&lt;-</span> ELE7_n_obj <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cod_actividad =</span> cod_actividad_letra,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>                <span class="at">cod_tamano =</span> <span class="fu">as.character</span>(cod_tamano)) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>cod_actividad_letra)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>eval_ratio <span class="ot">&lt;-</span> <span class="fu">assess</span>(prod_salarial, <span class="at">scheme =</span> <span class="st">&#39;chile_economics&#39;</span>,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>                     <span class="at">domain_info =</span> <span class="cn">TRUE</span>, <span class="at">table_n_obj =</span> table_n_obj, <span class="at">ratio_between_0_1 =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<p>The output is a <code>dataframe</code> that, in addition to
containing the information already generated, includes a column that
indicates whether the estimate is unreliable, less reliable or
reliable.</p>
<p>The function <code>assess</code> has a parameter that allows us to
know if the table should be published or not. Following the criteria of
the standard, if more than 50% of the estimates of a table are not
reliable, it should not be published.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Unemployment by region</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>desagregar <span class="ot">&lt;-</span> <span class="fu">create_size</span>(<span class="at">var =</span> <span class="st">&quot;desocupado&quot;</span>, <span class="at">domains =</span> <span class="st">&quot;region&quot;</span>, <span class="at">subpop =</span> <span class="st">&quot;fdt&quot;</span>, <span class="at">design =</span>  dc_ene)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co"># assess output</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>evaluacion_tot_desagreg <span class="ot">&lt;-</span> <span class="fu">assess</span>(desagregar, <span class="at">publish =</span> T)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>evaluacion_tot_desagreg</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Reset original options</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">options</span>(old_options)</span></code></pre></div>
<p>C:4qfZS5cc861292365.R</p>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>The data contained within the package has some editions.
It is important to note that haven::labelled objects may have some
collision with quality functions. If you want to import a dta file, all
variables that are of type haven::labelled must be converted to numeric
or character.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
